<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sphyrnidae Common Library: Logging</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="header.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Sphyrnidae Common Library
   &#160;<span id="projectnumber">2.0.1</span>
   </div>
   <div id="projectbrief">Shared Utilities/Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_logging_md.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Logging </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_C__Users_dougb_Desktop_Sphyrnidae_New_Common_Common_Logging_Logging"></a> </p>
<h1><a class="anchor" id="LoggingOverviewMd"></a>
Overview</h1>
<p>Logging has always been an afterthought for too many organizations. The <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger.html">ILogger</a> interface brings a robust set of logging to your application. What makes this special isn't the mere ability to log, but rather the content of what gets logged, the configurability, and the performance. Most loggers are synchronous, meaning that your application has to wait while the logging occurs. In this implementation, logging is asynchronous (the retrieval of some data may be synchronous).</p>
<p>Here are the basic steps for how something gets logged:</p><ol type="1">
<li>Logging statement appears in your code (see <a class="el" href="_logging_md.html#LoggingStatementsMd">Statements</a>)</li>
<li>Precheck occurs to determine if logging will actually occur for this call (see <a class="el" href="_logging_md.html#LoggingPrecheckMd">Precheck</a>)</li>
<li>The logger will initiate an object containing all the information to be logged (see <a class="el" href="_logging_md.html#LoggingInformationMd">Information</a>)</li>
<li>The logger will kick off an asynchronous thread to do the actual logging (see <a class="el" href="_logging_md.html#LoggingAsyncMd">Asynchronous</a>)</li>
<li>Additional properties on the logging object are set (see <a class="el" href="_logging_md.html#LoggingAdditionalPropertiesMd">Additional Properties</a>)</li>
<li>Logging object is sent to all enabled loggers (see <a class="el" href="_logging_md.html#LoggingLoggersMd">Loggers</a>)</li>
</ol>
<p>If your logging call is for something that will run a timer (eg. API, Web Service, Database, etc), the logging object will be returned to the caller. When the action has completed, this object is passed to a completion logging statement where the following occurs:</p><ol type="1">
<li>Ensure a valid logging object was given (if this object is null, nothing will be logged)</li>
<li>Logger will capture any additional information to be logged (see <a class="el" href="_logging_md.html#LoggingUpdateInfoMd">Update Information</a>)</li>
<li>Stops the timer that was started in the initial logging statement</li>
<li>The logger will kick off an asynchronous thread to the the rest of the work (see <a class="el" href="_logging_md.html#LoggingAsyncMd">Asynchronous</a>)</li>
<li>New thread will wait for the initial logging statement to complete (see <a class="el" href="_logging_md.html#LoggingPreviousCompletionMd">Previous Completion</a>)</li>
<li>Additional properties on the logging object are set (see <a class="el" href="_logging_md.html#LoggingAdditionalPropertiesMd">Additional Properties</a>)</li>
<li><a class="el" href="_alerts_md.html">Alerts</a> will be checked and possibly triggered</li>
<li>Logging object is sent to all enabled loggers (see <a class="el" href="_logging_md.html#LoggingLoggersMd">Loggers</a>)</li>
</ol>
<p>Lastly:</p><ol type="1">
<li>Any exceptions that occurred during logging will be captured via Email (see <a class="el" href="_logging_md.html#LoggingExceptionsMd">Exception Handling</a>)</li>
<li>You can customize what gets logged (see <a class="el" href="_logging_md.html#LoggingCustomizationsMd">Customizations</a>)</li>
<li>There are many configurations via this implementation using <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_loggers.html">ILoggers</a>, <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger_information.html">ILoggerInformation</a>, and <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger_configuration.html">ILoggerConfiguration</a></li>
</ol>
<p>Interface: <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger.html">ILogger</a></p>
<p>Mock: <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_non_logger.html">NonLogger</a></p>
<p>Implementation: <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_logger.html">Logger</a></p>
<h1><a class="anchor" id="LoggingStatementsMd"></a>
Statements</h1>
<p>The <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger.html">ILogger</a> lists all the possible calls that you can make to the logger. These are broken into 2 categories:</p><ol type="1">
<li>Insert-only statements</li>
<li>Updateable statements</li>
</ol>
<h2>Insert-Only</h2>
<p>All of these logging methods will log what needs to be logged (no subsequent logging statements can be made with the logging objects). </p><table class="doxtable">
<tr>
<th>Method </th><th>Information Class </th><th>Where Used </th><th>Description </th></tr>
<tr>
<td>Log </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_message_information.html">MessageInformation</a> </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_api_1_1_middleware_1_1_http_data_middleware.html">HttpDataMiddleware</a>: (Warning) If a non-secure request is received when HTTPS is required <br  />
<a class="el" href="class_sphyrnidae_1_1_common_1_1_signal_r_1_1_signal_r.html">SignalR</a>: (Suspend) On SignalR communication issues </td><td>Logs a simple user-defined message </td></tr>
<tr>
<td>Unauthorized </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_unauthorized_information.html">UnauthorizedInformation</a> </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_api_1_1_middleware_1_1_authentication_middleware.html">AuthenticationMiddleware</a>: Unauthenticated or Unauthorized request </td><td>Logs that an unauthorized call was made in the system (eg. HTTP 401/403) </td></tr>
<tr>
<td>Exception </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_exception_information.html">ExceptionInformation</a> </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_api_1_1_middleware_1_1_exception_middleware.html">ExceptionMiddleware</a> </td><td>Records that an unhandled (fatal) exception occurred in the system </td></tr>
<tr>
<td>HiddenException </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_exception_information.html">ExceptionInformation</a> </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_utilities_1_1_safe_try.html">SafeTry.LogException</a> </td><td>Records that an exception occurred in the system that was non-fatal </td></tr>
<tr>
<td>Custom1 </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_information1.html">CustomInformation1</a> </td><td></td><td>Allows you to create your own design-time class (see <a class="el" href="_logging_md.html#LoggingCustomizationsMd">Customizations</a>) </td></tr>
<tr>
<td>Custom2 </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_information2.html">CustomInformation2</a> </td><td></td><td>Allows you to create your own design-time class (see <a class="el" href="_logging_md.html#LoggingCustomizationsMd">Customizations</a>) </td></tr>
<tr>
<td>Custom3 </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_information3.html">CustomInformation3</a> </td><td></td><td>Allows you to create your own design-time class (see <a class="el" href="_logging_md.html#LoggingCustomizationsMd">Customizations</a>) </td></tr>
<tr>
<td>Generic </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html">BaseLogInformation</a> </td><td></td><td>Allows you to create your own generic design-time class (see <a class="el" href="_logging_md.html#LoggingCustomizationsMd">Customizations</a>) </td></tr>
</table>
<h2>Updateable</h2>
<p>The following methods will be called at the start of something, then again when something ends. The <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_timer_base_information.html">TimerBaseInformation</a> object will be returned from that "entry" call, and this object should be passed to the "exit" method. </p><table class="doxtable">
<tr>
<th>Entry Method </th><th>Exit Method </th><th>Information Class </th><th>Where Used </th><th>Description </th></tr>
<tr>
<td>AttributeEntry </td><td>AttributeExit </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_attribute_information.html">AttributeInformation</a> </td><td>None - there are some <a class="el" href="namespace_sphyrnidae_1_1_common_1_1_api_1_1_attributes.html">Attributes</a>, but none that are logging anything </td><td>Logs the execution of an attribute </td></tr>
<tr>
<td>ApiEntry </td><td>ApiExit </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_api_information.html">ApiInformation</a> </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_api_1_1_middleware_1_1_api_logging_middleware.html">ApiLoggingMiddleware</a> </td><td>Logs the execution of the API endpoint </td></tr>
<tr>
<td>DatabaseEntry </td><td>DatabaseExit </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_database_information.html">DatabaseInformation</a> </td><td><a class="el" href="_dal_md.html">Repository Calls</a> <br  />
<a class="el" href="_dal_md.html#DalTransactionsMd">Transactions</a> </td><td>Logs the execution of a database call </td></tr>
<tr>
<td>WebServiceEntry </td><td>WebServiceExit </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_web_service_information.html">WebServiceInformation</a> </td><td>Web Services: The actual call, not the preparation, nor parsing of result </td><td>Logs the execution of a web service call </td></tr>
<tr>
<td>MiddlewareEntry </td><td>MiddlewareExit </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_middleware_information.html">MiddlewareInformation</a> </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_api_1_1_middleware_1_1_api_logging_middleware.html">ApiLoggingMiddleware</a> <br  />
<a class="el" href="class_sphyrnidae_1_1_common_1_1_api_1_1_middleware_1_1_authentication_middleware.html">AuthenticationMiddleware</a> <br  />
<a class="el" href="class_sphyrnidae_1_1_common_1_1_api_1_1_middleware_1_1_exception_middleware.html">ExceptionMiddleware</a> <br  />
<a class="el" href="class_sphyrnidae_1_1_common_1_1_api_1_1_middleware_1_1_jwt_middleware.html">JwtMiddleware</a> </td><td>Logs the execution of a middleware call in the <a class="el" href="_api_md.html#ApiPipelineMd">API Pipeline</a> </td></tr>
<tr>
<td>TimerStart </td><td>TimerEnd </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_timer_base_information.html">TimerBaseInformation</a> </td><td></td><td>Allows you to create ad-hoc timer classes in your code for tracking how long sections of code run (see <a class="el" href="_logging_md.html#LoggingCustomizationsMd">Customizations</a>) </td></tr>
<tr>
<td>CustomTimer1Start </td><td>CustomTimerEnd </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_timer_information1.html">CustomTimerInformation1</a> </td><td></td><td>Allows you to create your own design-time class which acts as a timer (see <a class="el" href="_logging_md.html#LoggingCustomizationsMd">Customizations</a>) </td></tr>
<tr>
<td>CustomTimer2Start </td><td>CustomTimerEnd </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_timer_information2.html">CustomTimerInformation2</a> </td><td></td><td>Allows you to create your own design-time class which acts as a timer (see <a class="el" href="_logging_md.html#LoggingCustomizationsMd">Customizations</a>) </td></tr>
<tr>
<td>CustomTimer3Start </td><td>CustomTimerEnd </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_timer_information3.html">CustomTimerInformation3</a> </td><td></td><td>Allows you to create your own design-time class which acts as a timer (see <a class="el" href="_logging_md.html#LoggingCustomizationsMd">Customizations</a>) </td></tr>
<tr>
<td>Entry </td><td>Exit </td><td>User-supplied <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_timer_base_information.html">TimerBaseInformation</a> </td><td></td><td>If you don't want to use the pre-built classes inheriting from <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_timer_base_information.html">TimerBaseInformation</a>, you can create your own customized object (see <a class="el" href="_logging_md.html#LoggingCustomizationsMd">Customizations</a>) </td></tr>
</table>
<h1><a class="anchor" id="LoggingPrecheckMd"></a>
Precheck</h1>
<p>The pre-check step is a performance enhancement to quickly return if the "Type" (see <a class="el" href="_logging_md.html#LoggingConfigurationsMd">customizations</a> of object being logged is not enabled. The <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger_configuration.html">ILoggerConfiguration</a> (see <a class="el" href="_logging_md.html#LoggingConfigurationsMd">configurations</a>) has 2 properties that drive this:</p><ol type="1">
<li><a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger_configuration.html#a7e45820c11f764c52a89058734bc722e">Enabled</a></li>
<li>LoggerEnabled()</li>
</ol>
<p>If both of these return true, then the precheck passes. If either of these return false, the precheck fails and the logging statement will conclude without performing any data lookups or actual logging.</p>
<h1><a class="anchor" id="LoggingInformationMd"></a>
Information</h1>
<p>The information that gets logged is critical, and is a huge reason for the complexity of this logging sytem. All things that will be logged will contain the following pieces of information (see <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html">BaseLogInformation</a>): </p><table class="doxtable">
<tr>
<th>Property </th><th>Description </th><th>Customizeable </th></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#accfe96abad33cb9ab8fddd61287cf52d">Identifier</a> </td><td>A unique identifier (Guid) for each log <a class="el" href="_logging_md.html#LoggingStatementsMd">statement</a>. This identifier will be used to link the 'insert' statement with the 'update' statement. </td><td></td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#a4d529e03d19ed50c4d645fcf9a8de36e">Timestamp</a> </td><td>When the logging statement was called </td><td></td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#a43b60862912d941a2d52d5038b9630c7">Severity</a> </td><td>Similar to logging level, this gives an indication of how critical the message is. See <a href="https://docs.microsoft.com/en-us/dotnet/api/system.diagnostics.traceeventtype?view=net-5.0" target="blank">TraceEventType</a> for possible values </td><td></td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#ae8c1bfa1174ed8a8b5e019aeef72b460">Order</a> </td><td>All statements within a Request will be ordered. You can sort by this column to see all the statements for a given request in the correct order. Any calls to another web service will also be ordered as part of this. Eg. A, B, BA, BB, C: Three statements were logged on the main request, and the 2nd "B" request was a web service call that logged 2 statements. </td><td><a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger_information.html#a4deea771236476c7127fd7e6211b340a">LogOrderPrefix</a> <br  />
<a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger_information.html#a11f58a6048248e4a65be41dee38a5d36">LoggingOrder</a> </td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#a217d8c6ef095d1f2b2bc56c7a8a15dee">RequestId</a> </td><td>A unique identifier (Guid) that is used for all logging statements within a single Http Request </td><td><a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger_information.html#ad55f012644aec6f8f214c2ae36b43404">RequestId</a> </td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#a298735638473e50eb4a80d0f3da85cd4">Session</a> </td><td>If your front end application is generating a sessionId, it can pass this along to be logged. It should pass this in the Http header: <a class="el" href="interface_sphyrnidae_1_1_common_1_1_http_client_1_1_i_http_client_settings.html#a7f8bd8ea89efc1cc5c54c4a0c6888d7f">SessionIdHeader</a>. This will tie all requests together for a given "session" (eg. multiple Http Requests using the same window without refresh) </td><td><a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger_information.html#aaae8ecae1ceed10325a5001e34103a67">SessionId</a> </td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#a7e0b00bbdd1c05ae87eb94632222f9be">UserId</a> </td><td>If the user is logged in, this is their Id </td><td></td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#ab53551083e4791732ecc08a304be0130">IdentityProperties</a> </td><td>If you have custom items in your identity object that will always need to be logged, you should:<ol type="1">
<li>Create your own custom class that inherits from <a class="el" href="class_sphyrnidae_1_1_common_1_1_authentication_1_1_identity_1_1_base_identity.html">BaseIdentity</a></li>
<li>Add in your custom properties to that class</li>
<li>Override the GetCustomLoggingProperties() method and return any properties in that collection</li>
<li>In your <a class="el" href="_logging_md.html#LoggingLoggersMd">logger</a>, ensure <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_loggers_1_1_base_logger.html#a67dc581a15fbbe96ad03eee7aa1614b3">IncludeIdentity</a> is enabled</li>
<li>Retrieve that property from the <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_loggers_1_1_models_1_1_log_insert.html#a5693e045df56e38c5626f93ef2c35ec7">dictionary</a> </li>
</ol>
</td><td></td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#a43104a7ee8a333dbc58eb749caa06492">Message</a> </td><td>The main message to be logged </td><td></td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#a98c46dc878532bc568c12526bf3aa4ab">Category</a> </td><td>A category to group messages. For Timer statements (eg. has Entry() and Exit() methods), the Category will match the <a class="el" href="_logging_md.html#LoggingConfigurationsMd">Type</a> </td><td></td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#abe636c5e8f3688fb6158053e729a7cdc">Machine</a> </td><td>Name of the physical machine this code was running on </td><td></td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#aefcf2e1dc8f8dbacd388c996df108daa">Application</a> </td><td>Name of the application (eg. The same application could be running on multiple machines for load balancing) </td><td></td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#a3109112683dd3e98b1324528072e304a">StaticProperties</a> </td><td>Any additional properties you want included:<ol type="1">
<li>Derive and implement <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger_information.html#a4d738c9a7dcbb7ddd86b76daaf419526">StaticProperties</a></li>
<li>Update service registration (startup.cs) with your new class</li>
<li>In your <a class="el" href="_logging_md.html#LoggingLoggersMd">logger</a>, ensure <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_loggers_1_1_base_logger.html#a600a5585897360820c1873245277a5bb">IncludeStatic</a> is enabled</li>
<li>Retrieve that property from the <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_loggers_1_1_models_1_1_log_insert.html#a5693e045df56e38c5626f93ef2c35ec7">dictionary</a> </li>
</ol>
</td><td></td></tr>
</table>
<p>Most of these properties get set immediately in the context of the active application thread. However, the following properties are set <a class="el" href="_logging_md.html#LoggingAdditionalPropertiesMd">later</a> since they do not depend on an active object on the main thread:</p><ol type="1">
<li><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#abe636c5e8f3688fb6158053e729a7cdc">Machine</a></li>
<li><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#aefcf2e1dc8f8dbacd388c996df108daa">Application</a></li>
</ol>
<p>There is a slight overhead to setting all of these properties, but they are small and have been optimized. Any other custom properties should be set as follows:</p><ol type="1">
<li>Constructor: Never</li>
<li>Initialize(): This is what gets called to save off any information that was passed into the logging call. You should avoid directly setting custom properties in this method unless it is not thread-safe. You should instead just save off the object(s) into a member variable(s).</li>
<li>SetProperties(): This is where you'll take the saved object(s) from Initialize() and actually set the real properties (see <a class="el" href="_logging_md.html#LoggingAdditionalPropertiesMd">Additional Properties</a>)</li>
</ol>
<p>Here are all of the custom properties for each logging type. Note that the "key" is provided, and can be used to "hide" the value (see <a class="el" href="_logging_md.html#LoggingConfigurationsMd">configurations</a> for more information around these). </p><table class="doxtable">
<tr>
<th>Type </th><th>Key </th><th>When Set </th><th>Description </th></tr>
<tr>
<td>API </td><td>Route </td><td>Initialize </td><td>Unique route (template) </td></tr>
<tr>
<td>API </td><td>Http Method </td><td>Initialize </td><td>Request Method (eg. POST/PUT/GET/ETC) </td></tr>
<tr>
<td>API </td><td>Http Headers </td><td>Initialize (Formatting done in SetProperties) </td><td>The entire collection of Http Request headers </td></tr>
<tr>
<td>API </td><td>Query String </td><td>Initialize (Formatting done in SetProperties) </td><td>The querystring in the URL </td></tr>
<tr>
<td>API </td><td>Form Data </td><td>Initialize (Formatting done in SetProperties) </td><td>Form data in the Http Request </td></tr>
<tr>
<td>API </td><td>Request Data </td><td>Initialize (Formatting done in SetProperties) </td><td>Data in the Http Request that was posted (or other method) </td></tr>
<tr>
<td>API </td><td>Browser </td><td>Initialize </td><td>Type of user browser (Eg. "User-Agent" header) </td></tr>
<tr>
<td>API </td><td>Http Response </td><td>External Call </td><td>Http Response Status Code (Eg. 200) </td></tr>
<tr>
<td>API </td><td>Http Result </td><td>External Call </td><td>The complete Http Response object </td></tr>
<tr>
<td>Attribute </td><td>User-Supplied </td><td>Initialize </td><td>Any attribute information to be saved </td></tr>
<tr>
<td>Database </td><td>Connection </td><td>Initialize </td><td>Name of the <a class="el" href="class_sphyrnidae_1_1_common_1_1_dal_1_1_base_repo.html#a4e1e1f5b73442d50f60e4c74f8fd786c">database connection repo</a> </td></tr>
<tr>
<td>Database </td><td>SQL Parameters </td><td>SetProperties </td><td>SQL Parameters as name/value pairs </td></tr>
<tr>
<td>Exception, Hidden Exception </td><td>Stack Trace </td><td>SetProperties </td><td>The stack trace of the exception </td></tr>
<tr>
<td>Exception, Hidden Exception </td><td>Source </td><td>SetProperties </td><td>Source of the exception </td></tr>
<tr>
<td>Exception, Hidden Exception </td><td>Title </td><td>Initialize </td><td>Type/Title for the exception </td></tr>
<tr>
<td>Web Service </td><td>Route </td><td>Initialize </td><td>Unique route for the web service call </td></tr>
<tr>
<td>Web Service </td><td>Http Method </td><td>Initialize </td><td>Request Method (eg. POST/PUT/GET/ETC) </td></tr>
<tr>
<td>Web Service </td><td>Request Data </td><td>SetProperties </td><td>Data in the Http Request that was posted (or other method) </td></tr>
<tr>
<td>Web Service </td><td>Http Response </td><td>External Call </td><td>Http Response Status Code (Eg. 200) </td></tr>
<tr>
<td>Web Service </td><td>Http Result </td><td>External Call </td><td>The complete Http Response object </td></tr>
</table>
<h1><a class="anchor" id="LoggingAsyncMd"></a>
Asynchronous</h1>
<p>The <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_logger.html">Logger</a> implementation of the <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger.html">ILogger</a> interface runs asynchronously. The logging <a class="el" href="_logging_md.html#LoggingStatementsMd">statement</a>, <a class="el" href="_logging_md.html#LoggingPrecheckMd">precheck</a>, and setting of <a class="el" href="_logging_md.html#LoggingInformationMd">information</a> runs synchronously. But the remainder of the call will be done asynchronously (in the background, no await). Eg. <a class="el" href="_logging_md.html#LoggingAdditionalPropertiesMd">SetProperties()</a> and <a class="el" href="_logging_md.html#LoggingLoggersMd">loggers</a>. Even when you await the completion of the <a class="el" href="_logging_md.html#LoggingStatementsMd">statement</a>, this will continue to execute asynchronously. It is because of this asynchronous nature that you should be careful what gets set in Initialize() vs SetProperties() methods. Eg. the HttpRequest could be gone by the time the logger is used to actually log information related to this, so anything that relies on the HttpRequest object (or anything else that isn't thread-safe) should go in the Initialize() method. If you can find a way to push this into the SetProperties() method, or at least do the majority of processing in that method, then your overall logging performance will increase since those items will run asynchronously and not cause the main thread to wait during Initialize().</p>
<h1><a class="anchor" id="LoggingAdditionalPropertiesMd"></a>
Additional Properties</h1>
<p>Any custom properties on your <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html">logging information</a> class will need to do the following:</p><ol type="1">
<li>Following <a class="el" href="_logging_md.html#LoggingInformationMd">setting information</a>, there may still be some custom properties that need to be set</li>
<li>Obfuscation of the values based on HideKeys() (see <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger_configuration.html">ILoggerConfiguration</a>)</li>
<li>Taking the property, and assigning it to a Dictionary(string, string) - eg. key/value</li>
</ol>
<p>For non-timer statements, and for all entry() methods, SetProperties() is where this will all be done. The 3 dictionaries (HighProperties, MedProperties, LowProperties) are used by the <a class="el" href="_logging_md.html#LoggingLoggersMd">loggers</a>. Eg. some loggers might only save the 'High' properties.</p>
<p>For update timer statements (eg. exit() methods), UpdateProperties() is where this will all be done. Before this method is called, the 3 dictionaries will be cleared out so that only updated items will be logged on the update.</p>
<table class="doxtable">
<tr>
<th>Type </th><th>Key </th><th>Insert </th><th>Update </th><th>Dictionary </th></tr>
<tr>
<td>API </td><td>Route </td><td>Yes </td><td></td><td>High </td></tr>
<tr>
<td>API </td><td>Http Method </td><td>Yes </td><td></td><td>High </td></tr>
<tr>
<td>API </td><td>Http Headers </td><td>Yes </td><td></td><td>Med </td></tr>
<tr>
<td>API </td><td>Query String </td><td>Yes </td><td></td><td>Med </td></tr>
<tr>
<td>API </td><td>Form Data </td><td>Yes </td><td></td><td>Med </td></tr>
<tr>
<td>API </td><td>Request Data </td><td>Yes </td><td></td><td>Med </td></tr>
<tr>
<td>API </td><td>Browser </td><td>Yes </td><td></td><td>Low </td></tr>
<tr>
<td>API </td><td>Http Response </td><td></td><td>Yes </td><td>High </td></tr>
<tr>
<td>API </td><td>Http Result </td><td></td><td>Yes </td><td>Med </td></tr>
<tr>
<td>Attribute </td><td>User-Supplied </td><td>Yes </td><td></td><td>Med </td></tr>
<tr>
<td>Database </td><td>Connection </td><td>Yes </td><td></td><td>High </td></tr>
<tr>
<td>Database </td><td>SQL Parameters </td><td>Yes </td><td></td><td>Med </td></tr>
<tr>
<td>Exception, Hidden Exception </td><td>Stack Trace </td><td>Yes </td><td></td><td>High </td></tr>
<tr>
<td>Exception, Hidden Exception </td><td>Source </td><td>Yes </td><td></td><td>Med </td></tr>
<tr>
<td>Exception, Hidden Exception </td><td>Title </td><td>Yes </td><td></td><td>Low </td></tr>
<tr>
<td>Web Service </td><td>Route </td><td>Yes </td><td></td><td>High </td></tr>
<tr>
<td>Web Service </td><td>Http Method </td><td>Yes </td><td></td><td>High </td></tr>
<tr>
<td>Web Service </td><td>Request Data </td><td>Yes </td><td></td><td>Med </td></tr>
<tr>
<td>Web Service </td><td>Http Response </td><td></td><td>Yes </td><td>High </td></tr>
<tr>
<td>Web Service </td><td>Http Result </td><td></td><td>Yes </td><td>Med </td></tr>
</table>
<h1><a class="anchor" id="LoggingLoggersMd"></a>
Loggers</h1>
<p>A logger is a how the <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html">information</a> gets transferred to a physical storage location. Eg. File, Database, etc. A logger has the following characteristics:</p><ol type="1">
<li>Class inherits from BaseLogger</li>
<li>Is registered in your implementation of <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_loggers.html">ILoggers</a></li>
<li>Is <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger_configuration.html">configured</a> to perform logging - LoggerEnabled() method</li>
</ol>
<p>Available loggers (you can create your own too): </p><table class="doxtable">
<tr>
<th>Type </th><th>Name </th><th>Description </th><th>Recommended Types </th><th>Default Dictionaries </th></tr>
<tr>
<td>AwsLogger </td><td>AWS </td><td>Sends to CloudWatch (Not currently an option... You can view <a href="https://github.com/dbartels13/Common/blob/main/Common/Logging/Loggers/AwsLogger.cs" target="blank">source code</a> for example implementation) </td><td>All </td><td>All </td></tr>
<tr>
<td>AzureLogger </td><td>Azure </td><td>Sends to EventHub (Not currently an option... You can view <a href="https://github.com/dbartels13/Common/blob/main/Common/Logging/Loggers/AzureLogger.cs" target="blank">source code</a> for example implementation) </td><td>All </td><td>All </td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_loggers_1_1_debug_logger.html">DebugLogger</a> </td><td>Debug </td><td>Debugging messages in visual studio utilizing Debug.WriteLine() </td><td>Exception;Hidden Exception;HTTP Response Error;Long Running;Message;Timer </td><td>High </td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_loggers_1_1_email_logger.html">EmailLogger</a> </td><td>Email </td><td>Sends an <a class="el" href="_email_md.html">Email</a> to someone </td><td>Identity;Static;High;Med </td><td>Exception;Hidden Exception </td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_loggers_1_1_file_logger.html">FileLogger</a> </td><td>File </td><td>Writes to a file. A single file will be created every day in the format of $"log_{dt.DayOfYear}.log". File location is given by the variable "Logging_FilePath" - and put into subfolder of "Logs" at that path. If the <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#a43b60862912d941a2d52d5038b9630c7">severity</a> of the thing being logged is Warning, Error, or Critical, then a 2nd logfile will be created. Location of this log file will be in a subfolder of the Logs directory called "Highlights" with a naming convention of $"log_highlights_{dt.Year}_{dt:MMM}.log". </td><td>Identity;Static;High;Med </td><td>API;Exception;Hidden Exception;HTTP Response Error;Long Running;Message;Timer;Web Service </td></tr>
<tr>
<td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_loggers_1_1_log4_net_logger.html">Log4NetLogger</a> </td><td>Log4Net </td><td>Sends to Log4Net which has it's own logging configurations </td><td>All </td><td>All </td></tr>
</table>
<p>Registration of which loggers the system knows about is done via the <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_loggers.html">ILoggers</a> interface. The default registration is a Transient which returns an empty list (no loggers). Your implementation registration may wish to be Singleton (especially if there are multiple injections or any kind of business logic/lookups).</p>
<h1><a class="anchor" id="LoggingUpdateInfoMd"></a>
Update Information</h1>
<p>This only impacts 2 calls:</p><ol type="1">
<li>ApiExit()</li>
<li>WebServiceExit()</li>
</ol>
<p>In both cases, a call to SaveResult() will occur which will save off the returned Status Code and Response body. These will be the only candidates to be logged on the update statement (along with time to execute).</p>
<h1><a class="anchor" id="LoggingPreviousCompletionMd"></a>
Previous Completion</h1>
<p>Because logging is mostly <a class="el" href="_logging_md.html#LoggingAsyncMd">asynchronous</a>, the Exit() call might happen before the Entry() call has completed. Depending on your logger (eg. Database), you may need to capture the generated LogID (to be placed in <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#a59b8982d86c807fdc9f56de1d44fd916">NotResetProperties</a>). The Exit() log statement will depend on this completing, and it's good practice to ensure the Entry() log statement appears 1st in the logs. Therefore, the Exit() call will wait for the Entry() log statement to complete. It does this by setting the <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_timer_base_information.html#a6899fda4fc661a604e7727e1c078b709">SetComplete</a> flag when the Entry() statment completes. The Exit() statement will await the setting of this flag (technically sleep for 100ms and recheck for up to 1 minute).</p>
<h1><a class="anchor" id="LoggingExceptionsMd"></a>
Exception Handling</h1>
<p>Everything that occurs within the <a class="el" href="_logging_md.html#LoggingAsyncMd">asynchronous</a> portion of execution will have all exceptions handled. Because we are already in the logger, it doesn't make sense to log the exception (possible recursive loop). Instead, the logging error will be <a class="el" href="_email_md.html">e-mailed</a> and any exceptions during the Email process will be ignored. Note this utilizes the Email type: <a class="el" href="namespace_sphyrnidae_1_1_common_1_1_email_utilities_1_1_models.html#a906a7d0a948cce173dd2cb78f80fe718a197e128b8cf3accf46a996f3af0c67da">HiddenException</a>.</p>
<h1><a class="anchor" id="LoggingConfigurationsMd"></a>
Configurations</h1>
<p>The <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger_configuration.html">ILoggerConfiguration</a> contains a number for configurations. The main implementation is an abstract class LoggerConfiguration. The registered implementation is SphyrnidaeLoggerConfiguration. You will likely want to replace this with a different implementation. For best performance, it is recommended to register your implementation as Scoped. You can then save off the current configuration for all log statements in the request.</p>
<table class="doxtable">
<tr>
<th>Property/Method </th><th>Description </th><th>Default Implementation </th></tr>
<tr>
<td><a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger_configuration.html#a7e45820c11f764c52a89058734bc722e">Enabled</a> </td><td>Global flag that allows you to completely disable logging. If this is true, a lot more checks might still prevent statements from being logged. </td><td>True </td></tr>
<tr>
<td>TypeEnabled() </td><td>The <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#a23aa38d89ed4b20e19daf97a5a3c0506">Type</a> of the thing being logged can be enabled/disabled. See the Types table below. Enabled Types are a semicolon delimited list. </td><td>This list is retrieved from the configuration variable "Logging_Enabled_Types" </td></tr>
<tr>
<td>Include() </td><td>The information gathered for a class might be optional to actually "log" that information. Included properties are a semicolon delimited list. </td><td>This list is retrieved from the configuration variable "Logging_Includes" </td></tr>
<tr>
<td>LoggerEnabled() </td><td>Determines if a <a class="el" href="_logging_md.html#LoggingLoggersMd">logger</a> is enabled given a type. Name of enabled loggers are a semicolon delimited list. Types that are supported for a given logger are a semicolon delimited list. See the Types table below. </td><td>List of enabled loggers is retrieved from the configuration variable "Logging_Enabled_Loggers". List of types enabled for a given logger is retrieved from the configuration variable $"Logging_Enabled_{name}_Types". </td></tr>
<tr>
<td>HideKeys() </td><td>Listing of any custom properties that will be obfuscated in the log. Eg. Passwords. The property name will be the "key" of the item inserted into one of the dictionaries that will be read by the logger. Property keys are a semicolon delimited list. </td><td>This list is retrieved from the configuration variable "Logging_HideKeys" </td></tr>
<tr>
<td>MaxLength() </td><td>Maximum length of a custom property to be logged given a logger. This is useful for not logging an image, or large set of text. </td><td>1000: Also could be retrieved from the configuration variable $"Logging_{loggerName}_MaxLength" </td></tr>
</table>
<p>Existing <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html#a23aa38d89ed4b20e19daf97a5a3c0506">Types</a> (You can also create your own "Type" - see <a class="el" href="_logging_md.html#LoggingCustomizationsMd">Customizations</a>): </p><table class="doxtable">
<tr>
<th>Type </th><th>Info Class </th><th>Statement </th><th>Severity </th></tr>
<tr>
<td>API </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_api_information.html">ApiInformation</a> </td><td>ApiEntry() </td><td>Information </td></tr>
<tr>
<td>Attribute </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_attribute_information.html">AttributeInformation</a> </td><td>AttributeEntry() </td><td>Verbose </td></tr>
<tr>
<td>Database </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_database_information.html">DatabaseInformation</a> </td><td>DatabaseEntry() </td><td>Verbose </td></tr>
<tr>
<td>Exception </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_exception_information.html">ExceptionInformation</a> </td><td>Exception() </td><td>Error </td></tr>
<tr>
<td>Hidden Exception </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_exception_information.html">ExceptionInformation</a> </td><td>HiddenException() </td><td>Warning </td></tr>
<tr>
<td>HTTP Response Error </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_http_response_information.html">HttpResponseInformation</a> </td><td>None - see <a class="el" href="_alerts_md.html">Alerts</a> </td><td>Warning </td></tr>
<tr>
<td>Long Running </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_long_running_information.html">LongRunningInformation</a> </td><td>None - see <a class="el" href="_alerts_md.html">Alerts</a> </td><td>Warning </td></tr>
<tr>
<td>Message </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_message_information.html">MessageInformation</a> </td><td>Log() </td><td>User-Supplied </td></tr>
<tr>
<td>Middleware </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_middleware_information.html">MiddlewareInformation</a> </td><td>MiddlewareEntry() </td><td>Information </td></tr>
<tr>
<td>Timer </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_timer_information.html">TimerInformation</a> </td><td>TimerStart() </td><td>Information </td></tr>
<tr>
<td>Unauthorized </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_unauthorized_information.html">UnauthorizedInformation</a> </td><td>Unauthorized() </td><td>Warning </td></tr>
<tr>
<td>Web Service </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_web_service_information.html">WebServiceInformation</a> </td><td>WebServiceEntry() </td><td>Verbose </td></tr>
<tr>
<td>Developer Supplied </td><td><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_information1.html">CustomInformation1</a> <br  />
<a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_information2.html">CustomInformation2</a> <br  />
<a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_information3.html">CustomInformation3</a> <br  />
<a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_timer_information1.html">CustomTimerInformation1</a> <br  />
<a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_timer_information2.html">CustomTimerInformation2</a> <br  />
<a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_timer_information3.html">CustomTimerInformation3</a> <br  />
Custom <br  />
Custom </td><td>Custom1() <br  />
Custom2() <br  />
Custom3() <br  />
CustomTimer1Start() <br  />
CustomTimer2Start() <br  />
CustomTimer3Start() <br  />
Generic() <br  />
Entry() </td><td></td></tr>
</table>
<h1><a class="anchor" id="LoggingCustomizationsMd"></a>
Customizations</h1>
<p>Besides having most features be highly configurable, you may wish to customize the logger in any number of ways.</p>
<h2>Adding things to be logged</h2>
<p>You can extend any of the <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html">BaseLogInformation</a> classes to add properties. If you want to update or remove properties, you can update these in the <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html">SetProperties</a> or <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html">UpdateProperties</a> methods.</p>
<p>Once you have added a property by extending the intended class, you can register your own class instead of the default class.</p>
<p>Eg. </p><pre>
    // Extend a given class by adding a property
    public class MyNewExceptionInformation : ExceptionInformation
    {
        private string MyNewProperty { get; set; }
        public MyNewExceptionInformation(ILoggerInformation info, IApplicationSettings appSettings) : base(info, appSettings) { }

        public override void Initialize(Exception ex, string title, bool messageOnly)
        {
            base.Initialize(ex, title, messageOnly);
            MyNewProperty = "Some Value";
        }

        public override void SetProperties(ILoggerConfiguration config)
        {
            base.SetProperties(config);
            MedProperties.Add("My New Property", MyNewProperty);
        }
    }

    // Register this so that this class everywhere in place of ExceptionInformation (startup.cs)
    services.AddTransient&lt;ExceptionInformation, MyNewExceptionInformation&gt;();
</pre><h2>Design-time capabilities</h2>
<p>If you want to keep things cleaner, you can create your own logging class. To do this, you'll first inherit from one of the following "custom" classes:</p><ol type="1">
<li><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_information1.html">CustomInformation1</a></li>
<li><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_information2.html">CustomInformation2</a></li>
<li><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_information3.html">CustomInformation3</a></li>
<li><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_timer_information1.html">CustomTimerInformation1</a></li>
<li><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_timer_information2.html">CustomTimerInformation2</a></li>
<li><a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_custom_timer_information3.html">CustomTimerInformation3</a></li>
</ol>
<p>All of these interface methods take a generic type as the argument with an optional message. The generic type gets saved and you will, in your class, handle the logging of this generic object by assigning all of it's properties into the proper dictionary (High/Med/Low properties).</p>
<p>You will then add a service registration to specify that your class will be used when calling the proper method on the <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger.html">ILogger</a> interface. Note that when you wish to log something, this will use the "Custom()" methods on the interface. This method takes a generic object, which may or may not be the same type as you are expecting, so there is a potential for run-time anomolies.</p>
<p>If you wish to have a better name and work around these anomolies, it's recommended that you:</p><ol type="1">
<li>Create your own interface with the proper method signature - this interface should inherit from <a class="el" href="interface_sphyrnidae_1_1_common_1_1_logging_1_1_interfaces_1_1_i_logger.html">ILogger</a></li>
<li>Implement this method in a class which inherits from <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_logger.html">Logger</a></li>
<li>The implementation should simply forward on the call to the proper "Custom()" method.</li>
</ol>
<p>Eg. </p><pre>
    // Create your class which will act as the generic type
    public class Widget
    {
        public int Id { get; set; }
        public string Name { get; set; }
    }

    // Create your logging class which inherits from one of the CustomInformation classes
    public class WidgetInformation : CustomInformation1&lt;Widget&gt;
    {
        protected WidgetInformation(ILoggerInformation info, IApplicationSettings appSettings) : base(info, appSettings) { }
        public override string Type =&gt; "Widget"; // Required override
        protected override TraceEventType CustomSeverity =&gt; TraceEventType.Verbose; // Required override
        protected override string CustomMessage =&gt; "A widget was created"; // Optional override which means this will be used instead of a user-supplied message
        // Save off any properties you wish to have recorded - or you could just serialize the entire object into one of the dictionaries
        protected override void SetHighProperties(Dictionary&lt;string, string&gt; highProperties, Widget obj) =&gt; highProperties.Add("Name", obj.Name); 
        protected override void SetLowProperties(Dictionary&lt;string, string&gt; lowProperties, Widget obj) =&gt; lowProperties.Add("Id", obj.Id.ToString());
        protected override void SetMedProperties(Dictionary&lt;string, string&gt; highProperties, Widget obj) { }
    }

    // Service registration (startup.cs)
    services.TryAddTransient&lt;CustomInformation1&lt;Widget&gt;, WidgetInformation&gt;();

    // Test call
    ILogger logger; // Should be injected
    await logger.Custom1(new Widget { Name="Foo", Id=1 });
    await logger.Custom1("a string object"); // This will compile, but will be a run-time exception with service lookup

    // Alternative: Inherit and extend the interface
    public interface ICustomizedLogger : ILogger
    {
        Task Widget(Widget widget);
    }

    // Implementation
    public class CustomizedLogger : Logger, ICustomizedLogger
    {
        public CustomizedLogger(ILoggerConfiguration config, ILoggers loggers, IServiceProvider provider, IAlert alert, LongRunningInformation longRunningInfo, HttpResponseInformation httpResponseInfo, IApplicationSettings app, IEmail email)
            : base(config, loggers, provider, alert, longRunningInfo, httpResponseInfo, app, email)
            { }

        public async Task Widget(Widget widget) =&gt; await Custom1(widget);
    }

    // Registration (Note that the ILogger can still be used, but if you want to use your customized calls, you should use this one)
    services.TryAddTransient&lt;ICustomizedLogger, CustomizedLogger&gt;();

    // Make the new call
    ICustomizedLogger logger; // Should be injected
    logger.Widget(new Widget { Name="Foo", Id=1 });
</pre><h2>Additional Design-time capabilities</h2>
<p>You only create 3 Insert-Only custom classes, and 3 Updateable custom classes. If you need more, then you'll have to take a slightly different approach. Or, if you need to customize a class that will take more than 1 object as a parameter (You can always make this a single object by using a container object).</p>
<p>The approach is similar to the custom classes, except that you'll be directly inheritied from <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_base_log_information.html">BaseLogInformation</a>, or from <a class="el" href="class_sphyrnidae_1_1_common_1_1_logging_1_1_information_1_1_timer_base_information.html">TimerBaseInformation</a> (for timers). This class should be (see below for example):</p><ol type="1">
<li>Contain all the parameters/objects you wish</li>
<li>Have all custom properties settable via a single method (eg. Initialize() which will first call InitializeBase())</li>
<li>Ensure the custom properties are sent to the loggers via SetProperties()</li>
<li>This class itself should be passed in to the proper method<ol type="a">
<li>Non-Timer: Generic()</li>
<li>Timer: Entry() and Exit()</li>
</ol>
</li>
</ol>
<p>Eg. </p><pre>
    // Create your class inheriting from BaseLogInformation
    public class WidgetInformation : BaseLogInformation
    {
        public override string Type =&gt; "Widget";
        public string Name { get; private set; }
        public int Id { get; private set; }
        public WidgetInformation(ILoggerInformation info, IApplicationSettings appSettings) : base(info, appSettings) { }

        // Best practice to do all initializing/setting in a method
        public virtual void Initialize(string name, int id)
        {
            InitializeBase(TraceEventType.Information);
            Message = "Something happened with a widget"; // Optional to set this
            Category = "Widgets"; // Optional to set this
            Name = name;
            Id = id;
        }

        // The following method is where you'll save your properties into a dictionary which will be logged
        // Note: There is an UpdateProperties() that will be called for timers to reset this information (base method clears the dictionaries)
        public override void SetProperties(ILoggerConfiguration config)
        {
            base.SetProperties(config);
            HighProperties.Add("Name", Name);
            LowProperties.Add("Id", Id.ToString());
        }

    // How to use this
    ILoggerInformation info; // Should be injected
    IApplicationSettings app; // Should be injected
    var widgetInfo = new WidgetInformation(info, app);
    widgetInfo.Initialize("my name", 1);

    ILogger logger = null; // Should be injected
    await logger.Generic(widgetInfo);

    // No service registration necessary, which is why you "new" up an instance
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
