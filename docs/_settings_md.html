<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Sphyrnidae Common Library: Settings</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="header.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Sphyrnidae Common Library
   &#160;<span id="projectnumber">2.0.1</span>
   </div>
   <div id="projectbrief">Shared Utilities/Library</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_settings_md.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Settings </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="anchor" id="md_C__Users_dougb_Desktop_Sphyrnidae_New_Common_Common_Settings"></a> </p>
<h1><a class="anchor" id="SettingsOverviewMd"></a>
Overview</h1>
<p>A <a class="el" href="namespace_sphyrnidae_1_1_common_1_1_lookup.html">Setting</a> is a certain type of object that has the following properties:</p><ol type="1">
<li>Inherits from <a class="el" href="interface_sphyrnidae_1_1_common_1_1_lookup_1_1_i_lookup_settings.html">ILookupSettings</a></li>
<li>Contains a collection of objects that inherit from <a class="el" href="class_sphyrnidae_1_1_common_1_1_lookup_1_1_lookup_setting.html">LookupSetting</a></li>
<li>Retrieval of these objects (and settings for caching, etc) are implemented by <a class="el" href="interface_sphyrnidae_1_1_common_1_1_lookup_1_1_i_lookup_services.html">ILookupServices</a></li>
</ol>
<p>The implementation of a setting requires you to implement the following:</p><ol type="1">
<li>Implementation of <a class="el" href="class_sphyrnidae_1_1_common_1_1_lookup_1_1_lookup_setting.html">LookupSetting</a> - can be extended</li>
<li>Custom interface inheriting from <a class="el" href="interface_sphyrnidae_1_1_common_1_1_lookup_1_1_i_lookup_settings.html">ILookupSettings</a></li>
<li>Implementation of your custom interface (inherited from <a class="el" href="interface_sphyrnidae_1_1_common_1_1_lookup_1_1_i_lookup_settings.html">ILookupSettings</a> and <a class="el" href="class_sphyrnidae_1_1_common_1_1_lookup_1_1_base_lookup_setting.html">BaseLookupSetting</a>)</li>
<li>Custom interface inheriting from <a class="el" href="interface_sphyrnidae_1_1_common_1_1_lookup_1_1_i_lookup_services.html">ILookupServices</a></li>
<li>Implementation of your custom interface (inherited from <a class="el" href="interface_sphyrnidae_1_1_common_1_1_lookup_1_1_i_lookup_services.html">ILookupServices</a>)</li>
<li>Static method implementation class that inherits from SettingsLookup</li>
<li>Register your interface implementations (startup.cs)</li>
</ol>
<p>Yes, this might seem like a lot of setup to essentially have a Dictionary you can query. However, this can be configured and extended to handle any scenario you can imagine, and uses the best available design pattern to do so without much custom coding.</p>
<p>Why this is preferable:</p><ol type="1">
<li>Thread-safe: If you make this call multiple times before the data has been successfully looked up, the raw lookup of the data will occur only once</li>
<li>Things like User Preferences will be a user-specific listing</li>
<li>Caching is automatically a part of this</li>
<li>Allows you to map the data from any data source (eg. web service call to retrieve data in your <a class="el" href="interface_sphyrnidae_1_1_common_1_1_lookup_1_1_i_lookup_settings.html">ILookupSettings</a> implementation)</li>
<li>Fast query times using <a class="el" href="class_sphyrnidae_1_1_common_1_1_case_insensitive_binary_list.html">CaseInsensitiveBinaryList</a></li>
<li>Fault-tolerant: If a lookup fails, you can specify a default value</li>
<li>End result is a simple static method that will, almost magically, return a value for the given key</li>
</ol>
<h1><a class="anchor" id="SettingsWhereUsedMd"></a>
Where Used</h1>
<ol type="1">
<li>Variables</li>
<li>User Preferences</li>
<li><a class="el" href="_feature_toggle_md.html">Feature Toggle</a></li>
</ol>
<h1><a class="anchor" id="SettingsExampleMd"></a>
Examples</h1>
<pre>
    // Create your object type by inheriting from LookupSetting and extending for additional properties
    public class Widget : LookupSetting { }

    // Create a custom interface derived by ILookupSettings
    public interface IWidgetSettings : ILookupSettings&lt;Widget&gt; { }

    // Implement your custom interface derived from ILookupSettings and BaseLookupSetting
    // Can optionally override virtual methods for additional behavior
    public class WidgetSettings : BaseLookupSetting&lt;Widget&gt;, IWidgetSettings
    {
        public override string Key =&gt; "Widget";
        public override int CachingSeconds =&gt; 600;
        public override Task&lt;IEnumerable&lt;Widget&gt;&gt; GetAll()
        {
            var widgets = new List&lt;Widget&gt;
            {
                new Widget { Key = "widget1", Value = "foo1" },
                new Widget { Key = "widget2", Value = "foo2" },
                new Widget { Key = "widget3", Value = "foo3" }
            };
            return Task.FromResult(widgets.AsEnumerable());
        }
    }

    // Create a custom interface derived by ILookupServices
    public interface IWidgetServices : ILookupServices&lt;IWidgetSettings, Widget&gt; { }

    // Implement your custom interface derived from IWidgetServices
    public class WidgetServices : IWidgetServices
    {
        public ICache Cache { get; }
        public IWidgetSettings Service { get; }
        public WidgetServices(ICache cache, IWidgetSettings service)
        {
            Cache = cache;
            Service = service;
        }
    }

    // Static method implementation class that inherits from SettingsLookup
    // Can place any additional methods here for different lookups
    public class SettingsWidget : SettingsLookup&lt;IWidgetSettings, Widget&gt; { }

    // Register your implementations in startup.cs
    services.TryAddTransient&lt;IWidgetSettings, WidgetSettings&gt;();
    services.TryAddTransient&lt;IWidgetServices, WidgetServices&gt;();

    // Test everything out
    IWidgetServices service; // Should be injected
    var val = SettingsWidget.Get(service, "widget1", "default value"); // foo1
    val = SettingsWidget.Get(service, "widget18", "default value"); // default value
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
